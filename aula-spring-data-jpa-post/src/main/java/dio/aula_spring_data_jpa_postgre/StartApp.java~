package dio.aula_spring_data_jpa_postgre;

import dio.aula_spring_data_jpa_postgre.model.Usuario;
import dio.aula_spring_data_jpa_postgre.repository.UserRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

@Component
public class StartApp implements CommandLineRunner {

    @Autowired
    private UserRepository repository;

    @Override
    public void run(String... args) throws Exception {

        // Criação de um novo usuário
        Usuario user2 = new Usuario();
        user2.setName("Leticia");
        user2.setUsername("leca");
        user2.setPassword("7@82$@#");

        // Verificando se o usuário já existe
        if (repository.existsByUsername(user2.getUsername())) {
            System.out.println("Usuário com o nome de usuário " + user2.getUsername() + " já existe.");
        } else {
            // Salvando o segundo usuário
            repository.save(user2);
            System.out.println("Usuário " + user2.getUsername() + " salvo com sucesso!");
        }

        // Exibindo todos os usuários cadastrados
        for (Usuario u : repository.findAll()) {
            System.out.println(u);
        }
    }
}
